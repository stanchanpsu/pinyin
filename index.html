<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <title>pinyin</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- UI Layer: Score and Timer -->
    <div id="ui-layer">
      <div class="score-box">SCORE: <span id="score-val">0</span></div>
      <div class="timer-box">
        TIME LEFT: <span id="total-timer">02:00</span>
      </div>
    </div>

    <!-- Streak/Multiplier Bar -->
    <div id="streak-wrapper">
      <div id="streak-container">
        <div id="streak-inner">
          <div id="streak-fill"></div>
        </div>
      </div>
      <div class="multiplier-text" id="mult-text">1x</div>
      <div id="streak-count">0/5</div>
    </div>

    <!-- Main Game Area -->
    <div id="game-area">
      <div id="tiles-wrapper">
        <!-- Tiles injected by JS -->
      </div>
      <div class="input-wrapper">
        <input
          type="text"
          id="pinyin-input"
          placeholder="type pinyin..."
          autocomplete="off"
        />
        <!-- Mobile Input Display -->
        <div id="mobile-input-display" class="mobile-input-display"></div>
      </div>
    </div>

    <!-- Mobile On-screen Keyboard -->
    <div id="onscreen-keyboard" class="onscreen-keyboard"></div>

    <!-- Word Timer Bar -->
    <div id="timer-container">
      <div id="timer-bar"></div>
    </div>

    <!-- Overlay: Start & End Screens -->
    <div id="overlay">
      <!-- Start Screen -->
      <div id="start-screen">
        <!-- Logo Section -->
        <div class="logo-wrapper">
          <div class="majong-tile logo-tile">拼</div>
          <div class="majong-tile logo-tile">音</div>
        </div>

        <h1 class="game-title">PIN1YIN1</h1>

        <!-- View 1: Main Menu -->
        <div id="menu-main" class="menu-view">
          <button id="btn-goto-levels" class="level-btn">Start Game</button>
          <button id="btn-tutorial" class="level-btn secondary">
            How to Play
          </button>
        </div>

        <!-- View 2: Level Selection (Hidden by default) -->
        <div id="menu-levels" class="menu-view hidden">
          <p class="select-text">Select Difficulty</p>

          <div class="majong-grid">
            <!-- Row 1 -->
            <button class="majong-btn" data-lvl="hsk1">
              <span class="m-label">HSK</span>
              <span class="m-char">1</span>
            </button>

            <button class="majong-btn" data-lvl="hsk2">
              <span class="m-label">HSK</span>
              <span class="m-char">2</span>
            </button>

            <button class="majong-btn disabled">
              <span class="m-label">HSK</span>
              <span class="m-char">3</span>
              <span class="m-soon">Soon</span>
            </button>

            <!-- Row 2 -->
            <button class="majong-btn disabled">
              <span class="m-label">HSK</span>
              <span class="m-char">4</span>
              <span class="m-soon">Soon</span>
            </button>

            <button class="majong-btn disabled">
              <span class="m-label">HSK</span>
              <span class="m-char">5</span>
              <span class="m-soon">Soon</span>
            </button>

            <button class="majong-btn disabled">
              <span class="m-label">HSK</span>
              <span class="m-char">6</span>
              <span class="m-soon">Soon</span>
            </button>
          </div>

          <button id="btn-back-menu" class="back-btn">« Back</button>
        </div>
      </div>

      <!-- Consolidated Rules/Ready Screen -->
      <div id="rules-overlay" class="hidden">
        <div class="tutorial-content">
          <!-- Mode A: Close Button -->
          <button id="btn-rules-close" class="close-x hidden">×</button>

          <!-- Dynamic Title -->
          <h2 id="rules-title">How to Play</h2>

          <!-- Shared Content -->
          <div class="mockup-container">
            <div class="mockup-tiles-row">
              <div class="mockup-tile">你</div>
              <div class="mockup-tile">好</div>
            </div>
            <div class="mockup-input">ni3hao3</div>
          </div>

          <div class="tutorial-text">
            <h3>Type Pinyin with Tones</h3>
            <div class="tone-grid">
              <div class="tone-item"><span>ā</span> 1</div>
              <div class="tone-item"><span>á</span> 2</div>
              <div class="tone-item"><span>ǎ</span> 3</div>
              <div class="tone-item"><span>à</span> 4</div>
            </div>

            <h3>Special Pinyin</h3>
            <p>The letter <strong>ü</strong> is typed as <strong>v</strong>.</p>

            <h3>Skip Word</h3>
            <p>Type <strong>bzd</strong> for 'buzhidao' to skip.</p>
          </div>

          <!-- Mode B: Start Button -->
          <button
            id="btn-rules-start"
            class="level-btn hidden"
            style="margin-top: 20px"
          >
            START GAME
          </button>
        </div>
      </div>

      <!-- End Screen -->
      <div id="end-screen" class="hidden">
        <div class="end-header">
          <h1 class="game-title">GAME OVER</h1>
          <div class="end-stats-row">
            <div class="stat-badge">
              <span class="stat-label">DIFFICULTY</span>
              <span id="end-level-val" class="stat-val">HSK 1</span>
            </div>
            <div class="stat-badge">
              <span class="stat-label">SCORE</span>
              <span id="final-score" class="stat-val">0</span>
            </div>
          </div>
        </div>

        <!-- Scrollable Results Area -->
        <div class="results-container">
          <!-- Correct Column -->
          <div class="result-col col-correct">
            <h3 id="header-correct">Correct</h3>
            <div id="list-correct" class="word-list">
              <!-- JS will inject items here -->
              <!-- Example: <div class="word-item"><span class="ch">你好</span><span class="py">ni3hao3</span></div> -->
            </div>
          </div>

          <!-- Missed Column -->
          <div class="result-col col-missed">
            <h3 id="header-missed">Missed</h3>
            <div id="list-missed" class="word-list">
              <!-- JS will inject items here -->
            </div>
          </div>
        </div>

        <button id="play-again-btn">Play Again</button>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
